import{g as z,d as Q,e as _,r,i as Y,l as G,_ as v,j as e,m as D,n as J,w as Ee,q as S,B as x,y as De,a as Ie,u as _e,E as qe,v as $e,z as Oe,A as Te,C as He,D as Le,F as Ve}from"./index-65c487b5.js";import{a as We,S as ae}from"./Sidebar-8fdda4df.js";import{F as N}from"./DisplayFlex-c2d0742a.js";import{P as ze,b as me,I as Qe,M as Ye,Q as I,m as Ge,c as Je,T as g,k as Ke}from"./api-4684affb.js";import{d as Xe}from"./MoreVert-dc3c725b.js";import{c as Ze,g as es,e as ss,f as ne,h as re,i as ts}from"./postConnection-c82286f1.js";import{B as os,M as ie,u as as}from"./MenuItem-b48da8a1.js";import{T as ns}from"./TextField-fdae4a14.js";import{g as rs,f as le,s as P,b as ce}from"./userConnection-9f3b4703.js";import{N as is}from"./Navbar-6b8539d0.js";import{c as ls,g as cs}from"./chatConnection-dc181bfd.js";import{A as E}from"./Avatar-18d95d1c.js";import{D as ds}from"./makeStyles-c1e1b48a.js";import"./FormControl-8e3dbcd6.js";function us(s){return z("MuiCard",s)}Q("MuiCard",["root"]);const ms=["className","raised"],hs=s=>{const{classes:a}=s;return J({root:["root"]},us,a)},ps=_(ze,{name:"MuiCard",slot:"Root",overridesResolver:(s,a)=>a.root})(()=>({overflow:"hidden"})),gs=r.forwardRef(function(a,l){const i=Y({props:a,name:"MuiCard"}),{className:o,raised:n=!1}=i,m=G(i,ms),c=v({},i,{raised:n}),h=hs(c);return e.jsx(ps,v({className:D(h.root,o),elevation:n?8:void 0,ref:l,ownerState:c},m))}),xs=gs;function fs(s){return z("MuiCardActionArea",s)}const Cs=Q("MuiCardActionArea",["root","focusVisible","focusHighlight"]),W=Cs,bs=["children","className","focusVisibleClassName"],ws=s=>{const{classes:a}=s;return J({root:["root"],focusHighlight:["focusHighlight"]},fs,a)},js=_(Ee,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(s,a)=>a.root})(({theme:s})=>({display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",[`&:hover .${W.focusHighlight}`]:{opacity:(s.vars||s).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},[`&.${W.focusVisible} .${W.focusHighlight}`]:{opacity:(s.vars||s).palette.action.focusOpacity}})),ys=_("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(s,a)=>a.focusHighlight})(({theme:s})=>({overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:s.transitions.create("opacity",{duration:s.transitions.duration.short})})),ks=r.forwardRef(function(a,l){const i=Y({props:a,name:"MuiCardActionArea"}),{children:o,className:n,focusVisibleClassName:m}=i,c=G(i,bs),h=i,d=ws(h);return e.jsxs(js,v({className:D(d.root,n),focusVisibleClassName:D(m,d.focusVisible),ref:l,ownerState:h},c,{children:[o,e.jsx(ys,{className:d.focusHighlight,ownerState:h})]}))}),de=ks;function vs(s){return z("MuiCardMedia",s)}Q("MuiCardMedia",["root","media","img"]);const Ms=["children","className","component","image","src","style"],Ns=s=>{const{classes:a,isMediaComponent:l,isImageComponent:i}=s;return J({root:["root",l&&"media",i&&"img"]},vs,a)},Ss=_("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:l}=s,{isMediaComponent:i,isImageComponent:o}=l;return[a.root,i&&a.media,o&&a.img]}})(({ownerState:s})=>v({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},s.isMediaComponent&&{width:"100%"},s.isImageComponent&&{objectFit:"cover"})),As=["video","audio","picture","iframe","img"],Rs=["picture","img"],Us=r.forwardRef(function(a,l){const i=Y({props:a,name:"MuiCardMedia"}),{children:o,className:n,component:m="div",image:c,src:h,style:d}=i,f=G(i,Ms),w=As.indexOf(m)!==-1,C=!w&&c?v({backgroundImage:`url("${c}")`},d):d,j=v({},i,{component:m,isMediaComponent:w,isImageComponent:Rs.indexOf(m)!==-1}),y=Ns(j);return e.jsx(Ss,v({className:D(y.root,n),as:m,role:!w&&c?"img":void 0,ref:l,style:C,ownerState:j,src:w?c||h:void 0},f,{children:o}))}),ue=Us;function Fs({id:s,userId:a,image:l,click:i,borderView:o}){const[n,m]=r.useState(!1),[c,h]=r.useState(!1),[d,f]=r.useState(l),[w,C]=r.useState(null),j=S(p=>p.token),{_id:y}=S(p=>p.user),k=!!w,F=()=>m(!0),q=()=>{m(!1),h(!1)},$=p=>{C(p.currentTarget)},O=()=>{C(null)},T=async p=>{C(null),await Ze(p,j),i(),I.success("Post deleted")},A=async()=>{const p=await es(s,j),{description:R}=p.data.post;console.log(R),f(R),h(!0),m(!0)},B=()=>{console.log(d),ss(s,d,j),I.success("Your post was updated"),m(!1),h(!1)},H={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",boxShadow:24,borderRadios:"5px",p:2,height:"30rem",width:"35rem"};return e.jsxs(xs,{children:[e.jsx("div",{children:e.jsx(me,{open:n,onClose:q,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(os,{sx:H,children:[e.jsx(de,{children:e.jsx(ue,{component:"img",loading:"lazy",image:l,alt:""})}),c&&e.jsx(ns,{name:"description",fullWidth:!0,multiline:!0,sx:{marginTop:2},value:d,onChange:p=>f(p.target.value)}),c&&e.jsx(x,{sx:{margin:2},color:"success",variant:"contained",onClick:B,children:"Update"})]})})}),e.jsx("div",{children:o&&y===a&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{"aria-label":"more",id:"long-button","aria-controls":k?"long-menu":void 0,"aria-expanded":k?"true":void 0,"aria-haspopup":"true",onClick:$,children:e.jsx(Xe,{})}),e.jsxs(Ye,{id:"long-menu",MenuListProps:{"aria-labelledby":"long-button"},anchorEl:w,open:k,onClose:O,PaperProps:{style:{width:"20ch"}},children:[e.jsx(ie,{onClick:A,children:"Edit"}),e.jsx(ie,{onClick:()=>T(s),children:"Delete"})]})]})}),e.jsx(de,{children:e.jsx(ue,{onClick:F,sx:{height:"12rem"},component:"img",height:"140",image:l,alt:""})})]})}const Bs=Ge(s=>({root:{display:"flex",flexDirection:"column",alignItems:"center",padding:s.spacing(2)},profileContainer:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:s.spacing(2)},avatar:{width:s.spacing(15),height:s.spacing(15),marginBottom:s.spacing(2)},username:{fontWeight:"bold"},statsContainer:{display:"flex",justifyContent:"space-between",width:"100%",maxWidth:300,marginBottom:s.spacing(2)},stat:{textAlign:"center",cursor:"pointer"},statNumber:{fontWeight:"bold",marginBottom:s.spacing(.5)},button:{"&:hover":{backgroundColor:"red"}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},modalContent:{backgroundColor:s.palette.background.paper,boxShadow:s.shadows[5],width:"400px",height:"500px",padding:s.spacing(2,4,3)}})),Qs=()=>{const{_id:s,followers:a,requested:l,following:i}=S(t=>t.user),{id:o}=De(),n=Bs(),m=Je(),c=as(m.breakpoints.down("lg")),[h,d]=r.useState(!1),[f,w]=r.useState({}),[C,j]=r.useState([]),[y,k]=r.useState([]),[F,q]=r.useState(!1),[$,O]=r.useState({}),[T,A]=r.useState(""),[B,H]=r.useState(""),[p,R]=r.useState(""),[he,L]=r.useState(l.some(t=>t.id===o)),[K,pe]=r.useState(a.some(t=>t===o)),[ge,X]=r.useState(!1),V=Ie(),M=_e(),b=S(t=>t.token),Z=S(t=>t.user),ee=S(t=>t.user.blockingUsers),[xe,se]=r.useState(!1),te=async t=>{if(se(!0),d(!0),H(t),t==="followers"){const{followers:u}=await ne(o,b);k(u),d(!1)}else{const{followings:u}=await re(o,b);k(u),d(!1)}},fe=()=>{se(!1)},Ce=async()=>{try{const t=await rs(o,b);t.length===0&&X(!0);const u=await ts(o,b);w(t),j(u)}catch(t){throw X(!0),t}},be=()=>{q(!F)},we=async t=>{if(await le(s,t,b),M($e({unfollower:t})),B==="followers"){const{followers:u}=await ne(o,b);k(u),d(!1)}else{const{followings:u}=await re(o,b);k(u),d(!1)}},je=()=>{o!==s?Z.followers.includes(o)?A("unfollow"):A("follow"):A("")},ye=async()=>{await P(s,o),L(!0)},ke=async()=>{await P(s,o),L(!1)},ve=async()=>{await le(s,o,b),pe(!1),L(!1)};r.useEffect(()=>{Ce(),O(Z),je()},[o,F,T]),r.useEffect(()=>{ee.some(t=>t===o)?R("Blocked"):R("Unblocked")},[o,ee]);const Me=async()=>{try{await ls(s,o,b);const{chat:t}=await cs(s,o,b);M(Oe({currentchat:t[0]})),V("/chat")}catch(t){console.log(t)}},Ne=async()=>{const t=await ce(s,o);I.success(t.state),M(Te({blockUser:o}))},Se=async()=>{const t=await ce(s,o);I.success(t.state),M(He({unblockUser:o}))},Ae=async t=>{await P(s,t),M(Le({id:t}))},Re=async(t,u,U)=>{await P(s,t),M(Ve({id:t,userName:u,dp:U}))};return e.jsx(e.Fragment,{children:ge?e.jsx(qe,{}):e.jsxs(e.Fragment,{children:[e.jsx(is,{}),!c&&e.jsx(We,{}),e.jsx(N,{}),e.jsxs("div",{className:n.root,style:{marginLeft:"15vw"},children:[e.jsxs(N,{children:[e.jsx("div",{className:n.profileContainer,children:f.dp?e.jsx("div",{style:{margin:"0 10rem 2rem 0rem"},children:e.jsx(E,{sx:{width:"10rem",height:"10rem"},alt:f.userName,src:f.dp})}):e.jsx(E,{alt:f.userName})}),s===o&&e.jsx(x,{style:{margin:"0 2rem 8rem 2rem"},variant:"contained",sx:{backgroundColor:"lightgray"},className:n.button,onClick:()=>V(`/accounts/edit/${o}`),children:"Edit Profile"}),s!==o&&(p==="Blocked"?e.jsx(x,{style:{margin:"0 2rem 8rem 2rem"},variant:"contained",sx:{backgroundColor:"lightgray"},className:n.button,onClick:()=>Se(),children:"Unblock"}):e.jsx(x,{style:{margin:"0 2rem 8rem 2rem"},variant:"contained",sx:{backgroundColor:"lightgray"},className:n.button,onClick:()=>Ne(),children:"Block"}))]}),s!==o&&e.jsxs(N,{children:[K?e.jsx(x,{variant:"outlined",color:"info",sx:{mr:5,mb:2},onClick:ve,children:"Unfollow"}):he&&!K?e.jsx(x,{variant:"text",color:"info",sx:{mr:5,mb:2},onClick:ke,children:"Requested"}):e.jsx(x,{variant:"outlined",color:"info",sx:{mr:5,mb:2},onClick:ye,children:"Follow"}),e.jsx(x,{variant:"outlined",color:"info",sx:{ml:5,mb:2},onClick:Me,children:"Message"})]}),e.jsx(g,{children:f.bio}),e.jsx(g,{variant:"h5",m:2,className:n.username,children:f.name}),e.jsxs("div",{className:n.statsContainer,children:[e.jsxs("div",{className:n.stat,children:[e.jsx(g,{variant:"subtitle1",className:n.statNumber,children:C?C.length:0}),e.jsx(g,{variant:"body2",children:"Posts"})]}),e.jsxs("div",{className:n.stat,onClick:()=>te("followers"),children:[e.jsx(g,{variant:"subtitle1",className:n.statNumber,children:a?a.length:0}),e.jsx(g,{variant:"body2",children:"Followers"})]}),e.jsxs("div",{className:n.stat,onClick:()=>te("following"),children:[e.jsx(g,{variant:"subtitle1",className:n.statNumber,children:i?i.length:0}),e.jsx(g,{variant:"body2",children:"Following"})]})]}),e.jsx(me,{open:xe,onClose:fe,className:n.modal,"aria-labelledby":"modal-title","aria-describedby":"modal-description",children:e.jsxs("div",{className:n.modalContent,style:{maxHeight:"500px",overflowY:"scroll"},children:[e.jsx(g,{variant:"h2",textAlign:"center",children:B==="followers"?"Followers":"Following"}),e.jsx(ds,{}),h?e.jsxs(e.Fragment,{children:[e.jsx(ae,{sx:{width:"95%",height:"60px",margin:"10px"}}),e.jsx(ae,{sx:{width:"95%",height:"60px",margin:"10px"}})]}):e.jsxs(e.Fragment,{children:[y.length===0&&e.jsx(g,{children:"No friends"}),y==null?void 0:y.map((t,u)=>e.jsxs(N,{mt:3,children:[e.jsxs("div",{style:{display:"flex"},children:[t.dp?e.jsx("div",{className:"profile-picture",children:e.jsx(E,{alt:t.userName,src:t.dp})}):e.jsx(E,{alt:t.userName}),e.jsxs("div",{style:{paddingLeft:"15px"},children:[e.jsx(g,{variant:"h6",children:t.userName},t.id),e.jsx(g,{children:t.name})]})]}),t._id!==s?$.followers.includes(t._id)?e.jsx(x,{sx:{backgroundColor:"whitesmoke",borderRadius:"10px",color:"black"},onClick:()=>we(t._id),children:"Remove"}):l.some(U=>U.id===t._id)?e.jsx(x,{sx:{backgroundColor:"whitesmoke",borderRadius:"10px",color:"black"},onClick:()=>Ae(t._id),children:"Requested"}):e.jsx(x,{sx:{backgroundColor:"whitesmoke",borderRadius:"10px",color:"black"},onClick:()=>Re(t._id,t.userName,t.dp),children:"Request"}):e.jsx(x,{sx:{color:"black"},onClick:()=>V(`/profile/${s}`),children:"view"})]},u))]})]})}),e.jsx(N,{width:c?"100%":"60rem",sx:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},children:C==null?void 0:C.map(({_id:t,userId:u,description:U,userName:Ue,image:oe,likes:Fe,comments:Be},Pe)=>oe?e.jsx(N,{sx:{m:c?"2rem .2rem .2rem .2rem":"5rem .2rem .2rem .2rem"},children:e.jsx(Fs,{id:t,userId:u,description:U,userName:Ue,image:oe,likes:Fe,comments:Be,click:be,borderView:u===o},t)},Pe):null)}),e.jsx(Ke,{position:"bottom-left"})]})]})})};export{Qs as default};
