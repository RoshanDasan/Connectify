import{h as z,i as Y,l as I,P as Ee,r,m as G,_ as Q,n as v,j as e,o as _,q as J,t as _e,v as S,M as me,w as De,T as Ie,B as x,a as $e,x as qe,y as Oe,z as ae,C as He,Q as D,D as Te,E as Le,F as Ve,G as We,H as ze,J as Ye,b as Ge,u as Qe,K as Je,N as Ke,S as Xe,L as M,A as P,d as g,O as Ze,R as ne,k as es,U as re,V as ie,W as ss,X as ts,Y as le,Z as os,$ as E,a0 as as,a1 as ce,a2 as ns,a3 as rs,a4 as is,a5 as ls}from"./index-135ee7aa.js";import{c as cs,g as ds}from"./chatConnection-57446954.js";function us(s){return z("MuiCard",s)}Y("MuiCard",["root"]);const ms=["className","raised"],hs=s=>{const{classes:a}=s;return J({root:["root"]},us,a)},ps=I(Ee,{name:"MuiCard",slot:"Root",overridesResolver:(s,a)=>a.root})(()=>({overflow:"hidden"})),gs=r.forwardRef(function(a,l){const i=G({props:a,name:"MuiCard"}),{className:o,raised:n=!1}=i,m=Q(i,ms),c=v({},i,{raised:n}),h=hs(c);return e.jsx(ps,v({className:_(h.root,o),elevation:n?8:void 0,ref:l,ownerState:c},m))}),xs=gs;function fs(s){return z("MuiCardActionArea",s)}const Cs=Y("MuiCardActionArea",["root","focusVisible","focusHighlight"]),W=Cs,bs=["children","className","focusVisibleClassName"],ws=s=>{const{classes:a}=s;return J({root:["root"],focusHighlight:["focusHighlight"]},fs,a)},js=I(_e,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(s,a)=>a.root})(({theme:s})=>({display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",[`&:hover .${W.focusHighlight}`]:{opacity:(s.vars||s).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},[`&.${W.focusVisible} .${W.focusHighlight}`]:{opacity:(s.vars||s).palette.action.focusOpacity}})),ys=I("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(s,a)=>a.focusHighlight})(({theme:s})=>({overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:s.transitions.create("opacity",{duration:s.transitions.duration.short})})),ks=r.forwardRef(function(a,l){const i=G({props:a,name:"MuiCardActionArea"}),{children:o,className:n,focusVisibleClassName:m}=i,c=Q(i,bs),h=i,d=ws(h);return e.jsxs(js,v({className:_(d.root,n),focusVisibleClassName:_(m,d.focusVisible),ref:l,ownerState:h},c,{children:[o,e.jsx(ys,{className:d.focusHighlight,ownerState:h})]}))}),de=ks;function vs(s){return z("MuiCardMedia",s)}Y("MuiCardMedia",["root","media","img"]);const Ns=["children","className","component","image","src","style"],Ms=s=>{const{classes:a,isMediaComponent:l,isImageComponent:i}=s;return J({root:["root",l&&"media",i&&"img"]},vs,a)},Ss=I("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:l}=s,{isMediaComponent:i,isImageComponent:o}=l;return[a.root,i&&a.media,o&&a.img]}})(({ownerState:s})=>v({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},s.isMediaComponent&&{width:"100%"},s.isImageComponent&&{objectFit:"cover"})),Rs=["video","audio","picture","iframe","img"],Us=["picture","img"],As=r.forwardRef(function(a,l){const i=G({props:a,name:"MuiCardMedia"}),{children:o,className:n,component:m="div",image:c,src:h,style:d}=i,f=Q(i,Ns),w=Rs.indexOf(m)!==-1,C=!w&&c?v({backgroundImage:`url("${c}")`},d):d,j=v({},i,{component:m,isMediaComponent:w,isImageComponent:Us.indexOf(m)!==-1}),y=Ms(j);return e.jsx(Ss,v({className:_(y.root,n),as:m,role:!w&&c?"img":void 0,ref:l,style:C,ownerState:j,src:w?c||h:void 0},f,{children:o}))}),ue=As;function Fs({id:s,userId:a,image:l,click:i,borderView:o}){const[n,m]=r.useState(!1),[c,h]=r.useState(!1),[d,f]=r.useState(l),[w,C]=r.useState(null),j=S(p=>p.token),{_id:y}=S(p=>p.user),k=!!w,F=()=>m(!0),$=()=>{m(!1),h(!1)},q=p=>{C(p.currentTarget)},O=()=>{C(null)},H=async p=>{C(null),await He(p,j),i(),D.success("Post deleted")},R=async()=>{const p=await Te(s,j),{description:U}=p.data.post;console.log(U),f(U),h(!0),m(!0)},B=()=>{console.log(d),Le(s,d,j),D.success("Your post was updated"),m(!1),h(!1)},T={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",boxShadow:24,borderRadios:"5px",p:2,height:"30rem",width:"35rem"};return e.jsxs(xs,{children:[e.jsx("div",{children:e.jsx(me,{open:n,onClose:$,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(De,{sx:T,children:[e.jsx(de,{children:e.jsx(ue,{component:"img",loading:"lazy",image:l,alt:""})}),c&&e.jsx(Ie,{name:"description",fullWidth:!0,multiline:!0,sx:{marginTop:2},value:d,onChange:p=>f(p.target.value)}),c&&e.jsx(x,{sx:{margin:2},color:"success",variant:"contained",onClick:B,children:"Update"})]})})}),e.jsx("div",{children:o&&y===a&&e.jsxs(e.Fragment,{children:[e.jsx($e,{"aria-label":"more",id:"long-button","aria-controls":k?"long-menu":void 0,"aria-expanded":k?"true":void 0,"aria-haspopup":"true",onClick:q,children:e.jsx(qe,{})}),e.jsxs(Oe,{id:"long-menu",MenuListProps:{"aria-labelledby":"long-button"},anchorEl:w,open:k,onClose:O,PaperProps:{style:{width:"20ch"}},children:[e.jsx(ae,{onClick:R,children:"Edit"}),e.jsx(ae,{onClick:()=>H(s),children:"Delete"})]})]})}),e.jsx(de,{children:e.jsx(ue,{onClick:F,sx:{height:"12rem"},component:"img",height:"140",image:l,alt:""})})]})}const Bs=Ve(s=>({root:{display:"flex",flexDirection:"column",alignItems:"center",padding:s.spacing(2)},profileContainer:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:s.spacing(2)},avatar:{width:s.spacing(15),height:s.spacing(15),marginBottom:s.spacing(2)},username:{fontWeight:"bold"},statsContainer:{display:"flex",justifyContent:"space-between",width:"100%",maxWidth:300,marginBottom:s.spacing(2)},stat:{textAlign:"center",cursor:"pointer"},statNumber:{fontWeight:"bold",marginBottom:s.spacing(.5)},button:{"&:hover":{backgroundColor:"red"}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},modalContent:{backgroundColor:s.palette.background.paper,boxShadow:s.shadows[5],width:"400px",height:"500px",padding:s.spacing(2,4,3)}})),_s=()=>{const{_id:s,followers:a,requested:l,following:i}=S(t=>t.user),{id:o}=We(),n=Bs(),m=ze(),c=Ye(m.breakpoints.down("lg")),[h,d]=r.useState(!1),[f,w]=r.useState({}),[C,j]=r.useState([]),[y,k]=r.useState([]),[F,$]=r.useState(!1),[q,O]=r.useState({}),[H,R]=r.useState(""),[B,T]=r.useState(""),[p,U]=r.useState(""),[he,L]=r.useState(l.some(t=>t.id===o)),[K,pe]=r.useState(a.some(t=>t===o)),[ge,X]=r.useState(!1),V=Ge(),N=Qe(),b=S(t=>t.token),Z=S(t=>t.user),ee=S(t=>t.user.blockingUsers),[xe,se]=r.useState(!1),te=async t=>{if(se(!0),d(!0),T(t),t==="followers"){const{followers:u}=await re(o,b);k(u),d(!1)}else{const{followings:u}=await ie(o,b);k(u),d(!1)}},fe=()=>{se(!1)},Ce=async()=>{try{const t=await ss(o,b);t.length===0&&X(!0);const u=await ts(o,b);w(t),j(u)}catch(t){throw X(!0),t}},be=()=>{$(!F)},we=async t=>{if(await le(s,t,b),N(os({unfollower:t})),B==="followers"){const{followers:u}=await re(o,b);k(u),d(!1)}else{const{followings:u}=await ie(o,b);k(u),d(!1)}},je=()=>{o!==s?Z.followers.includes(o)?R("unfollow"):R("follow"):R("")},ye=async()=>{await E(s,o),L(!0)},ke=async()=>{await E(s,o),L(!1)},ve=async()=>{await le(s,o,b),pe(!1),L(!1)};r.useEffect(()=>{Ce(),O(Z),je()},[o,F,H]),r.useEffect(()=>{ee.some(t=>t===o)?U("Blocked"):U("Unblocked")},[o,ee]);const Ne=async()=>{try{await cs(s,o,b);const{chat:t}=await ds(s,o,b);N(as({currentchat:t[0]})),V("/chat")}catch(t){console.log(t)}},Me=async()=>{const t=await ce(s,o);D.success(t.state),N(ns({blockUser:o}))},Se=async()=>{const t=await ce(s,o);D.success(t.state),N(rs({unblockUser:o}))},Re=async t=>{await E(s,t),N(is({id:t}))},Ue=async(t,u,A)=>{await E(s,t),N(ls({id:t,userName:u,dp:A}))};return e.jsx(e.Fragment,{children:ge?e.jsx(Je,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ke,{}),!c&&e.jsx(Xe,{}),e.jsx(M,{}),e.jsxs("div",{className:n.root,style:{marginLeft:"15vw"},children:[e.jsxs(M,{children:[e.jsx("div",{className:n.profileContainer,children:f.dp?e.jsx("div",{style:{margin:"0 10rem 2rem 0rem"},children:e.jsx(P,{sx:{width:"10rem",height:"10rem"},alt:f.userName,src:f.dp})}):e.jsx(P,{alt:f.userName})}),s===o&&e.jsx(x,{style:{margin:"0 2rem 8rem 2rem"},variant:"contained",sx:{backgroundColor:"lightgray"},className:n.button,onClick:()=>V(`/accounts/edit/${o}`),children:"Edit Profile"}),s!==o&&(p==="Blocked"?e.jsx(x,{style:{margin:"0 2rem 8rem 2rem"},variant:"contained",sx:{backgroundColor:"lightgray"},className:n.button,onClick:()=>Se(),children:"Unblock"}):e.jsx(x,{style:{margin:"0 2rem 8rem 2rem"},variant:"contained",sx:{backgroundColor:"lightgray"},className:n.button,onClick:()=>Me(),children:"Block"}))]}),s!==o&&e.jsxs(M,{children:[K?e.jsx(x,{variant:"outlined",color:"info",sx:{mr:5,mb:2},onClick:ve,children:"Unfollow"}):he&&!K?e.jsx(x,{variant:"text",color:"info",sx:{mr:5,mb:2},onClick:ke,children:"Requested"}):e.jsx(x,{variant:"outlined",color:"info",sx:{mr:5,mb:2},onClick:ye,children:"Follow"}),e.jsx(x,{variant:"outlined",color:"info",sx:{ml:5,mb:2},onClick:Ne,children:"Message"})]}),e.jsx(g,{children:f.bio}),e.jsx(g,{variant:"h5",m:2,className:n.username,children:f.name}),e.jsxs("div",{className:n.statsContainer,children:[e.jsxs("div",{className:n.stat,children:[e.jsx(g,{variant:"subtitle1",className:n.statNumber,children:C?C.length:0}),e.jsx(g,{variant:"body2",children:"Posts"})]}),e.jsxs("div",{className:n.stat,onClick:()=>te("followers"),children:[e.jsx(g,{variant:"subtitle1",className:n.statNumber,children:a?a.length:0}),e.jsx(g,{variant:"body2",children:"Followers"})]}),e.jsxs("div",{className:n.stat,onClick:()=>te("following"),children:[e.jsx(g,{variant:"subtitle1",className:n.statNumber,children:i?i.length:0}),e.jsx(g,{variant:"body2",children:"Following"})]})]}),e.jsx(me,{open:xe,onClose:fe,className:n.modal,"aria-labelledby":"modal-title","aria-describedby":"modal-description",children:e.jsxs("div",{className:n.modalContent,style:{maxHeight:"500px",overflowY:"scroll"},children:[e.jsx(g,{variant:"h2",textAlign:"center",children:B==="followers"?"Followers":"Following"}),e.jsx(Ze,{}),h?e.jsxs(e.Fragment,{children:[e.jsx(ne,{sx:{width:"95%",height:"60px",margin:"10px"}}),e.jsx(ne,{sx:{width:"95%",height:"60px",margin:"10px"}})]}):e.jsxs(e.Fragment,{children:[y.length===0&&e.jsx(g,{children:"No friends"}),y==null?void 0:y.map((t,u)=>e.jsxs(M,{mt:3,children:[e.jsxs("div",{style:{display:"flex"},children:[t.dp?e.jsx("div",{className:"profile-picture",children:e.jsx(P,{alt:t.userName,src:t.dp})}):e.jsx(P,{alt:t.userName}),e.jsxs("div",{style:{paddingLeft:"15px"},children:[e.jsx(g,{variant:"h6",children:t.userName},t.id),e.jsx(g,{children:t.name})]})]}),t._id!==s?q.followers.includes(t._id)?e.jsx(x,{sx:{backgroundColor:"whitesmoke",borderRadius:"10px",color:"black"},onClick:()=>we(t._id),children:"Remove"}):l.some(A=>A.id===t._id)?e.jsx(x,{sx:{backgroundColor:"whitesmoke",borderRadius:"10px",color:"black"},onClick:()=>Re(t._id),children:"Requested"}):e.jsx(x,{sx:{backgroundColor:"whitesmoke",borderRadius:"10px",color:"black"},onClick:()=>Ue(t._id,t.userName,t.dp),children:"Request"}):e.jsx(x,{sx:{color:"black"},onClick:()=>V(`/profile/${s}`),children:"view"})]},u))]})]})}),e.jsx(M,{width:c?"100%":"60rem",sx:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},children:C==null?void 0:C.map(({_id:t,userId:u,description:A,userName:Ae,image:oe,likes:Fe,comments:Be},Pe)=>oe?e.jsx(M,{sx:{m:c?"2rem .2rem .2rem .2rem":"5rem .2rem .2rem .2rem"},children:e.jsx(Fs,{id:t,userId:u,description:A,userName:Ae,image:oe,likes:Fe,comments:Be,click:be,borderView:u===o},t)},Pe):null)}),e.jsx(es,{position:"bottom-left"})]})]})})};export{_s as default};
