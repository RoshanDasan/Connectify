import{g as z,d as Q,e as _,r,i as Y,l as G,_ as v,j as e,m as D,n as J,x as Be,q as S,B as x,z as Pe,a as Ee,u as De,v as Ie,A as _e,C as qe,D as $e,E as Oe,F as Te}from"./index-bf33396f.js";import{a as He,S as te}from"./Sidebar-8a667937.js";import{F as N}from"./DisplayFlex-abd62217.js";import{P as Le,b as ue,I as Ve,M as We,Q as I,m as ze,c as Qe,T as g,k as Ye}from"./api-ccc87ef9.js";import{d as Ge}from"./MoreVert-3a293c4d.js";import{c as Je,g as Ke,e as Xe,f as ae,h as ne,i as Ze}from"./postConnection-54f6813b.js";import{B as es,M as re,u as ss}from"./MenuItem-dbe7b88d.js";import{T as os}from"./TextField-f331c2a9.js";import{g as ts,f as ie,s as P,b as le}from"./userConnection-a0238410.js";import{N as as}from"./Navbar-af09f3f9.js";import{c as ns,g as rs}from"./chatConnection-4e149db2.js";import{A as E}from"./Avatar-efc85e3e.js";import{D as is}from"./makeStyles-f89d6ef3.js";import"./FormControl-a981626d.js";function ls(s){return z("MuiCard",s)}Q("MuiCard",["root"]);const cs=["className","raised"],ds=s=>{const{classes:a}=s;return J({root:["root"]},ls,a)},us=_(Le,{name:"MuiCard",slot:"Root",overridesResolver:(s,a)=>a.root})(()=>({overflow:"hidden"})),ms=r.forwardRef(function(a,l){const i=Y({props:a,name:"MuiCard"}),{className:t,raised:n=!1}=i,m=G(i,cs),c=v({},i,{raised:n}),h=ds(c);return e.jsx(us,v({className:D(h.root,t),elevation:n?8:void 0,ref:l,ownerState:c},m))}),hs=ms;function ps(s){return z("MuiCardActionArea",s)}const gs=Q("MuiCardActionArea",["root","focusVisible","focusHighlight"]),W=gs,xs=["children","className","focusVisibleClassName"],fs=s=>{const{classes:a}=s;return J({root:["root"],focusHighlight:["focusHighlight"]},ps,a)},Cs=_(Be,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(s,a)=>a.root})(({theme:s})=>({display:"block",textAlign:"inherit",borderRadius:"inherit",width:"100%",[`&:hover .${W.focusHighlight}`]:{opacity:(s.vars||s).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},[`&.${W.focusVisible} .${W.focusHighlight}`]:{opacity:(s.vars||s).palette.action.focusOpacity}})),bs=_("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(s,a)=>a.focusHighlight})(({theme:s})=>({overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:s.transitions.create("opacity",{duration:s.transitions.duration.short})})),ws=r.forwardRef(function(a,l){const i=Y({props:a,name:"MuiCardActionArea"}),{children:t,className:n,focusVisibleClassName:m}=i,c=G(i,xs),h=i,d=fs(h);return e.jsxs(Cs,v({className:D(d.root,n),focusVisibleClassName:D(m,d.focusVisible),ref:l,ownerState:h},c,{children:[t,e.jsx(bs,{className:d.focusHighlight,ownerState:h})]}))}),ce=ws;function js(s){return z("MuiCardMedia",s)}Q("MuiCardMedia",["root","media","img"]);const ys=["children","className","component","image","src","style"],ks=s=>{const{classes:a,isMediaComponent:l,isImageComponent:i}=s;return J({root:["root",l&&"media",i&&"img"]},js,a)},vs=_("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:l}=s,{isMediaComponent:i,isImageComponent:t}=l;return[a.root,i&&a.media,t&&a.img]}})(({ownerState:s})=>v({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},s.isMediaComponent&&{width:"100%"},s.isImageComponent&&{objectFit:"cover"})),Ms=["video","audio","picture","iframe","img"],Ns=["picture","img"],Ss=r.forwardRef(function(a,l){const i=Y({props:a,name:"MuiCardMedia"}),{children:t,className:n,component:m="div",image:c,src:h,style:d}=i,f=G(i,ys),w=Ms.indexOf(m)!==-1,C=!w&&c?v({backgroundImage:`url("${c}")`},d):d,j=v({},i,{component:m,isMediaComponent:w,isImageComponent:Ns.indexOf(m)!==-1}),y=ks(j);return e.jsx(vs,v({className:D(y.root,n),as:m,role:!w&&c?"img":void 0,ref:l,style:C,ownerState:j,src:w?c||h:void 0},f,{children:t}))}),de=Ss;function As({id:s,userId:a,image:l,click:i,borderView:t}){const[n,m]=r.useState(!1),[c,h]=r.useState(!1),[d,f]=r.useState(l),[w,C]=r.useState(null),j=S(p=>p.token),{_id:y}=S(p=>p.user),k=!!w,F=()=>m(!0),q=()=>{m(!1),h(!1)},$=p=>{C(p.currentTarget)},O=()=>{C(null)},T=async p=>{C(null),await Je(p,j),i(),I.success("Post deleted")},A=async()=>{const p=await Ke(s,j),{description:R}=p.data.post;console.log(R),f(R),h(!0),m(!0)},B=()=>{console.log(d),Xe(s,d,j),I.success("Your post was updated"),m(!1),h(!1)},H={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",boxShadow:24,borderRadios:"5px",p:2,height:"30rem",width:"35rem"};return e.jsxs(hs,{children:[e.jsx("div",{children:e.jsx(ue,{open:n,onClose:q,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(es,{sx:H,children:[e.jsx(ce,{children:e.jsx(de,{component:"img",loading:"lazy",image:l,alt:""})}),c&&e.jsx(os,{name:"description",fullWidth:!0,multiline:!0,sx:{marginTop:2},value:d,onChange:p=>f(p.target.value)}),c&&e.jsx(x,{sx:{margin:2},color:"success",variant:"contained",onClick:B,children:"Update"})]})})}),e.jsx("div",{children:t&&y===a&&e.jsxs(e.Fragment,{children:[e.jsx(Ve,{"aria-label":"more",id:"long-button","aria-controls":k?"long-menu":void 0,"aria-expanded":k?"true":void 0,"aria-haspopup":"true",onClick:$,children:e.jsx(Ge,{})}),e.jsxs(We,{id:"long-menu",MenuListProps:{"aria-labelledby":"long-button"},anchorEl:w,open:k,onClose:O,PaperProps:{style:{width:"20ch"}},children:[e.jsx(re,{onClick:A,children:"Edit"}),e.jsx(re,{onClick:()=>T(s),children:"Delete"})]})]})}),e.jsx(ce,{children:e.jsx(de,{onClick:F,sx:{height:"12rem"},component:"img",height:"140",image:l,alt:""})})]})}const Rs=ze(s=>({root:{display:"flex",flexDirection:"column",alignItems:"center",padding:s.spacing(2)},profileContainer:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:s.spacing(2)},avatar:{width:s.spacing(15),height:s.spacing(15),marginBottom:s.spacing(2)},username:{fontWeight:"bold"},statsContainer:{display:"flex",justifyContent:"space-between",width:"100%",maxWidth:300,marginBottom:s.spacing(2)},stat:{textAlign:"center",cursor:"pointer"},statNumber:{fontWeight:"bold",marginBottom:s.spacing(.5)},button:{"&:hover":{backgroundColor:"red"}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},modalContent:{backgroundColor:s.palette.background.paper,boxShadow:s.shadows[5],width:"400px",height:"500px",padding:s.spacing(2,4,3)}})),Vs=()=>{const{_id:s,followers:a,requested:l,following:i}=S(o=>o.user),{id:t}=Pe(),n=Rs(),m=Qe(),c=ss(m.breakpoints.down("lg")),[h,d]=r.useState(!1),[f,w]=r.useState({}),[C,j]=r.useState([]),[y,k]=r.useState([]),[F,q]=r.useState(!1),[$,O]=r.useState({}),[T,A]=r.useState(""),[B,H]=r.useState(""),[p,R]=r.useState(""),[me,L]=r.useState(l.some(o=>o.id===t)),[K,he]=r.useState(a.some(o=>o===t)),V=Ee(),M=De(),b=S(o=>o.token),X=S(o=>o.user),Z=S(o=>o.user.blockingUsers),[pe,ee]=r.useState(!1);console.log(a,"fo");const se=async o=>{if(ee(!0),d(!0),H(o),o==="followers"){const{followers:u}=await ae(t,b);k(u),d(!1)}else{const{followings:u}=await ne(t,b);k(u),d(!1)}},ge=()=>{ee(!1)},xe=async()=>{try{const o=await ts(t,b),u=await Ze(t,b);w(o),j(u)}catch(o){throw o}},fe=()=>{q(!F)},Ce=async o=>{if(await ie(s,o,b),M(Ie({unfollower:o})),B==="followers"){const{followers:u}=await ae(t,b);k(u),d(!1)}else{const{followings:u}=await ne(t,b);k(u),d(!1)}};console.log(l,"req");const be=()=>{t!==s?X.followers.includes(t)?A("unfollow"):A("follow"):A("")},we=async()=>{await P(s,t),L(!0)},je=async()=>{await P(s,t),L(!1)},ye=async()=>{await ie(s,t,b),he(!1),L(!1)};r.useEffect(()=>{xe(),O(X),be()},[t,F,T]),r.useEffect(()=>{Z.some(o=>o===t)?R("Blocked"):R("Unblocked")},[t,Z]);const ke=async()=>{try{await ns(s,t,b);const{chat:o}=await rs(s,t,b);M(_e({currentchat:o[0]})),V("/chat")}catch(o){console.log(o)}},ve=async()=>{const o=await le(s,t);I.success(o.state),M(qe({blockUser:t}))},Me=async()=>{const o=await le(s,t);I.success(o.state),M($e({unblockUser:t}))},Ne=async o=>{await P(s,o),M(Oe({id:o}))},Se=async(o,u,U)=>{await P(s,o),M(Te({id:o,userName:u,dp:U}))};return e.jsxs(e.Fragment,{children:[e.jsx(as,{}),!c&&e.jsx(He,{}),e.jsx(N,{}),e.jsxs("div",{className:n.root,style:{marginLeft:"15vw"},children:[e.jsxs(N,{children:[e.jsx("div",{className:n.profileContainer,children:f.dp?e.jsx("div",{style:{margin:"0 10rem 2rem 0rem"},children:e.jsx(E,{sx:{width:"10rem",height:"10rem"},alt:f.userName,src:f.dp})}):e.jsx(E,{alt:f.userName})}),s===t&&e.jsx(x,{style:{margin:"0 2rem 8rem 2rem"},variant:"contained",sx:{backgroundColor:"lightgray"},className:n.button,onClick:()=>V(`/accounts/edit/${t}`),children:"Edit Profile"}),s!==t&&(p==="Blocked"?e.jsx(x,{style:{margin:"0 2rem 8rem 2rem"},variant:"contained",sx:{backgroundColor:"lightgray"},className:n.button,onClick:()=>Me(),children:"Unblock"}):e.jsx(x,{style:{margin:"0 2rem 8rem 2rem"},variant:"contained",sx:{backgroundColor:"lightgray"},className:n.button,onClick:()=>ve(),children:"Block"}))]}),s!==t&&e.jsxs(N,{children:[K?e.jsx(x,{variant:"outlined",color:"info",sx:{mr:5,mb:2},onClick:ye,children:"Unfollow"}):me&&!K?e.jsx(x,{variant:"text",color:"info",sx:{mr:5,mb:2},onClick:je,children:"Requested"}):e.jsx(x,{variant:"outlined",color:"info",sx:{mr:5,mb:2},onClick:we,children:"Follow"}),e.jsx(x,{variant:"outlined",color:"info",sx:{ml:5,mb:2},onClick:ke,children:"Message"})]}),e.jsx(g,{children:f.bio}),e.jsx(g,{variant:"h5",m:2,className:n.username,children:f.name}),e.jsxs("div",{className:n.statsContainer,children:[e.jsxs("div",{className:n.stat,children:[e.jsx(g,{variant:"subtitle1",className:n.statNumber,children:C?C.length:0}),e.jsx(g,{variant:"body2",children:"Posts"})]}),e.jsxs("div",{className:n.stat,onClick:()=>se("followers"),children:[e.jsx(g,{variant:"subtitle1",className:n.statNumber,children:a?a.length:0}),e.jsx(g,{variant:"body2",children:"Followers"})]}),e.jsxs("div",{className:n.stat,onClick:()=>se("following"),children:[e.jsx(g,{variant:"subtitle1",className:n.statNumber,children:i?i.length:0}),e.jsx(g,{variant:"body2",children:"Following"})]})]}),e.jsx(ue,{open:pe,onClose:ge,className:n.modal,"aria-labelledby":"modal-title","aria-describedby":"modal-description",children:e.jsxs("div",{className:n.modalContent,style:{maxHeight:"500px",overflowY:"scroll"},children:[e.jsx(g,{variant:"h2",textAlign:"center",children:B==="followers"?"Followers":"Following"}),e.jsx(is,{}),h?e.jsxs(e.Fragment,{children:[e.jsx(te,{sx:{width:"95%",height:"60px",margin:"10px"}}),e.jsx(te,{sx:{width:"95%",height:"60px",margin:"10px"}})]}):e.jsxs(e.Fragment,{children:[y.length===0&&e.jsx(g,{children:"No friends"}),y==null?void 0:y.map((o,u)=>e.jsxs(N,{mt:3,children:[e.jsxs("div",{style:{display:"flex"},children:[o.dp?e.jsx("div",{className:"profile-picture",children:e.jsx(E,{alt:o.userName,src:o.dp})}):e.jsx(E,{alt:o.userName}),e.jsxs("div",{style:{paddingLeft:"15px"},children:[e.jsx(g,{variant:"h6",children:o.userName},o.id),e.jsx(g,{children:o.name})]})]}),o._id!==s?$.followers.includes(o._id)?e.jsx(x,{sx:{backgroundColor:"whitesmoke",borderRadius:"10px",color:"black"},onClick:()=>Ce(o._id),children:"Remove"}):l.some(U=>U.id===o._id)?e.jsx(x,{sx:{backgroundColor:"whitesmoke",borderRadius:"10px",color:"black"},onClick:()=>Ne(o._id),children:"Requested"}):e.jsx(x,{sx:{backgroundColor:"whitesmoke",borderRadius:"10px",color:"black"},onClick:()=>Se(o._id,o.userName,o.dp),children:"Request"}):e.jsx(x,{sx:{color:"black"},onClick:()=>V(`/profile/${s}`),children:"view"})]},u))]})]})}),e.jsx(N,{width:c?"100%":"60rem",sx:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},children:C==null?void 0:C.map(({_id:o,userId:u,description:U,userName:Ae,image:oe,likes:Re,comments:Ue},Fe)=>oe?e.jsx(N,{sx:{m:c?"2rem .2rem .2rem .2rem":"5rem .2rem .2rem .2rem"},children:e.jsx(As,{id:o,userId:u,description:U,userName:Ae,image:oe,likes:Re,comments:Ue,click:fe,borderView:u===t},o)},Fe):null)}),e.jsx(Ye,{position:"bottom-left"})]})]})};export{Vs as default};
